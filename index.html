<script>
  const LEADERBOARD_URL = "https://lfxlakrgxgxtadogmrpn.supabase.co/functions/v1/banish-him-get";

  async function fetchLeaderboard() {
    const tbody = document.querySelector("#leaderboard tbody");
    tbody.innerHTML = `<tr><td colspan="3" class="loading">Loading...</td></tr>`;

    try {
      const res = await fetch(LEADERBOARD_URL);
      if (!res.ok) throw new Error("Failed to fetch leaderboard");

      const data = await res.json();
      tbody.innerHTML = "";

      if (!data || data.length === 0) {
        tbody.innerHTML = "<tr><td colspan='3' class='loading'>No records yet</td></tr>";
        return;
      }

      data.forEach((entry, index) => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${index + 1}</td>
          <td>${entry.username}</td>
          <td>${entry.time_seconds}</td>
        `;
        tbody.appendChild(tr);
      });
    } catch (err) {
      console.error(err);
      tbody.innerHTML = "<tr><td colspan='3' class='loading'>Error loading leaderboard</td></tr>";
    }
  }

  fetchLeaderboard();
</script>